<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ü–∏—Ç–æ–º–µ—Ü-—Å–∏–º—É–ª—è—Ç–æ—Ä</title>
  <style>
    :root{
      --bg:#0f1220;
      --panel:#171a2b;
      --panel2:#1e2238;
      --text:#e9ecff;

      --hunger:#ff9b2f;      /* –æ—Ä–∞–Ω–∂–µ–≤—ã–π */
      --sleep:#7ec8ff;       /* —Å–≤–µ—Ç–ª–æ-—Å–∏–Ω–∏–π */
      --mood:#ffe28a;        /* –Ω–µ–∂–Ω–æ-–∂—ë–ª—Ç—ã–π */
      --clean:#eaf7ff;       /* –≥–æ–ª—É–±–æ–≤–∞—Ç–æ-–±–µ–ª—ã–π */
      --danger:#ff4d6d;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 30% 10%, #20254a 0%, var(--bg) 55%);
      color:var(--text);
      display:flex;
      min-height:100vh;
    }

    .wrap{
      width:min(1100px, 96vw);
      margin:auto;
      display:grid;
      grid-template-columns: 1fr 340px;
      gap:14px;
      padding:14px 0;
    }

    /* –ò–≥—Ä–æ–≤–∞—è —Å—Ü–µ–Ω–∞ */
    .scene{
      position:relative;
      background: linear-gradient(180deg, #1a1f3a 0%, #12152a 100%);
      border-radius:16px;
      overflow:hidden;
      min-height:520px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    .ground{
      position:absolute;
      left:0; right:0; bottom:0;
      height:120px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    }

    /* –ü–∏—Ç–æ–º–µ—Ü */
    .pet{
      position:absolute;
      bottom:90px;
      width:120px;
      height:120px;
      image-rendering: pixelated;
      user-select:none;
      -webkit-user-drag:none;
      transform: translateX(0) scaleX(1);
      /* –ù–ò–ö–ê–ö–ò–• –æ–±–≤–æ–¥–æ–∫/—Ñ–∏–ª—å—Ç—Ä–æ–≤ */
      filter:none;
    }

    /* –ü–∞–Ω–µ–ª—å UI */
    .ui{
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .card{
      background: linear-gradient(180deg, var(--panel) 0%, var(--panel2) 100%);
      border-radius:16px;
      padding:12px;
      box-shadow: 0 10px 30px rgba(0,0,0,.28);
    }

    .title{
      font-weight:700;
      letter-spacing:.2px;
      margin:0 0 8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }

    .money{
      font-variant-numeric: tabular-nums;
      opacity:.95;
      background: rgba(255,255,255,.06);
      padding:4px 8px;
      border-radius:999px;
    }

    .bars{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .barRow{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .barTop{
      display:flex;
      justify-content:space-between;
      font-size:12px;
      opacity:.9;
    }

    .bar{
      height:12px;
      border-radius:999px;
      background: rgba(255,255,255,.08);
      overflow:hidden;
    }

    .fill{
      height:100%;
      width:50%;
      border-radius:999px;
      transition: width .18s linear;
    }

    .btnRow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }

    button{
      border:0;
      border-radius:12px;
      padding:10px 10px;
      background: rgba(255,255,255,.08);
      color:var(--text);
      cursor:pointer;
      font-weight:600;
      transition: transform .06s ease, background .12s ease, opacity .12s ease;
      user-select:none;
    }
    button:hover{ background: rgba(255,255,255,.12); }
    button:active{ transform: translateY(1px); }
    button:disabled{ opacity:.45; cursor:not-allowed; }

    .shop{
      display:grid;
      grid-template-columns:1fr;
      gap:8px;
    }
    .shopItem{
      background: rgba(255,255,255,.06);
      border-radius:14px;
      padding:10px;
      display:grid;
      grid-template-columns: 1fr auto;
      gap:10px;
      align-items:center;
    }
    .shopItem small{opacity:.85; display:block; line-height:1.35}
    .price{
      font-variant-numeric: tabular-nums;
      opacity:.95;
    }

    .toast{
      margin-top:8px;
      font-size:13px;
      opacity:.92;
      min-height:18px;
    }

    /* –ú—è—á–∏–∫ */
    .ball{
      position:absolute;
      width:20px;
      height:20px;
      border-radius:50%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.9), rgba(255,255,255,.25));
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
      pointer-events:none;
      opacity:0;
      transform: translate(-50%, -50%);
    }

    /* –ê–¥–∞–ø—Ç–∏–≤ */
    @media (max-width: 940px){
      body{ align-items:flex-start; }
      .wrap{
        grid-template-columns: 1fr;
        padding:14px 0 24px;
      }
      .scene{ min-height:420px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="scene" id="scene">
      <img class="pet" id="pet" src="walk.png" alt="pet" />
      <div class="ball" id="ball"></div>
      <div class="ground"></div>
    </div>

    <div class="ui">
      <div class="card">
        <h3 class="title">
          –ü–∏—Ç–æ–º–µ—Ü
          <span class="money">üí∞ <span id="money">30</span></span>
        </h3>

        <div class="bars">
          <div class="barRow">
            <div class="barTop"><span>–ì–æ–ª–æ–¥</span><span id="hungerTxt">‚Äî</span></div>
            <div class="bar"><div class="fill" id="hungerFill" style="background:var(--hunger)"></div></div>
          </div>

          <div class="barRow">
            <div class="barTop"><span>–°–æ–Ω</span><span id="sleepTxt">‚Äî</span></div>
            <div class="bar"><div class="fill" id="sleepFill" style="background:var(--sleep)"></div></div>
          </div>

          <div class="barRow">
            <div class="barTop"><span>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</span><span id="moodTxt">‚Äî</span></div>
            <div class="bar"><div class="fill" id="moodFill" style="background:var(--mood)"></div></div>
          </div>

          <div class="barRow">
            <div class="barTop"><span>–ß–∏—Å—Ç–æ—Ç–∞</span><span id="cleanTxt">‚Äî</span></div>
            <div class="bar"><div class="fill" id="cleanFill" style="background:var(--clean)"></div></div>
          </div>
        </div>

        <div class="toast" id="toast"></div>
      </div>

      <div class="card">
        <h3 class="title">–ò–≥—Ä–∞—Ç—å</h3>
        <div class="btnRow">
          <button id="petBtn">ü§ö –ü–æ–≥–ª–∞–¥–∏—Ç—å</button>
          <button id="ballBtn">üéæ –ë—Ä–æ—Å–∏—Ç—å –º—è—á–∏–∫</button>
        </div>
        <div style="margin-top:8px; font-size:12px; opacity:.85; line-height:1.35;">
          –ü–æ–¥—Å–∫–∞–∑–∫–∞: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –ø–∞–¥–∞—é—Ç. –ò–≥—Ä—ã –ø–æ–≤—ã—à–∞—é—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, –Ω–æ –ø–∞—á–∫–∞—é—Ç –ø–∏—Ç–æ–º—Ü–∞.
        </div>
      </div>

      <div class="card">
        <h3 class="title">–ú–∞–≥–∞–∑–∏–Ω –µ–¥—ã</h3>
        <div class="shop" id="shop"></div>
      </div>
    </div>
  </div>

  <script>
    // ---------- –£—Ç–∏–ª–∏—Ç—ã ----------
    const clamp = (v, a=0, b=100) => Math.max(a, Math.min(b, v));
    const fmt = v => `${Math.round(v)}%`;

    // ---------- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã ----------
    const state = {
      money: 30,
      stats: {
        hunger: 65,
        sleep: 70,
        mood: 60,
        clean: 75,
      },
      // –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞ (–≤ –ø–∏–∫—Å–µ–ª—è—Ö –≤–Ω—É—Ç—Ä–∏ —Å—Ü–µ–Ω—ã)
      petX: 80,
      petV: 70,   // px/—Å–µ–∫
      dir: 1,     // 1 –≤–ø—Ä–∞–≤–æ, -1 –≤–ª–µ–≤–æ
      // —Å–∫–æ—Ä–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç–æ–≤ (–≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö/—Å–µ–∫)
      decay: {
        hunger: 1.2,   // –≥–æ–ª–æ–¥ –ø–∞–¥–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ
        sleep: 0.7,
        mood: 0.5,
        clean: 0.6
      }
    };

    // ---------- –ï–¥–∞ (3 –≤–∏–¥–∞) ----------
    const foods = [
      {
        id: "kibble",
        name: "–°—É—Ö–æ–π –∫–æ—Ä–º",
        price: 6,
        desc: "+18 –≥–æ–ª–æ–¥, -3 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (—Å–∫—É—á–Ω–æ–≤–∞—Ç–æ)",
        effect: s => { s.hunger += 18; s.mood -= 3; }
      },
      {
        id: "fish",
        name: "–†—ã–±–∫–∞",
        price: 10,
        desc: "+22 –≥–æ–ª–æ–¥, +6 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, -4 —á–∏—Å—Ç–æ—Ç–∞",
        effect: s => { s.hunger += 22; s.mood += 6; s.clean -= 4; }
      },
      {
        id: "treat",
        name: "–õ–∞–∫–æ–º—Å—Ç–≤–æ",
        price: 8,
        desc: "+10 –≥–æ–ª–æ–¥, +14 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ",
        effect: s => { s.hunger += 10; s.mood += 14; }
      }
    ];

    // ---------- DOM ----------
    const scene = document.getElementById("scene");
    const pet = document.getElementById("pet");
    const ball = document.getElementById("ball");

    const moneyEl = document.getElementById("money");
    const toastEl = document.getElementById("toast");

    const hungerFill = document.getElementById("hungerFill");
    const sleepFill  = document.getElementById("sleepFill");
    const moodFill   = document.getElementById("moodFill");
    const cleanFill  = document.getElementById("cleanFill");

    const hungerTxt = document.getElementById("hungerTxt");
    const sleepTxt  = document.getElementById("sleepTxt");
    const moodTxt   = document.getElementById("moodTxt");
    const cleanTxt  = document.getElementById("cleanTxt");

    const petBtn = document.getElementById("petBtn");
    const ballBtn = document.getElementById("ballBtn");
    const shopEl = document.getElementById("shop");

    // ---------- UI: –º–∞–≥–∞–∑–∏–Ω ----------
    function buildShop(){
      shopEl.innerHTML = "";
      for(const item of foods){
        const row = document.createElement("div");
        row.className = "shopItem";
        row.innerHTML = `
          <div>
            <div style="font-weight:700">${item.name}</div>
            <small>${item.desc}</small>
          </div>
          <div style="display:flex; flex-direction:column; gap:6px; align-items:flex-end">
            <div class="price">üí∞ ${item.price}</div>
            <button data-buy="${item.id}">–ö—É–ø–∏—Ç—å</button>
          </div>
        `;
        shopEl.appendChild(row);
      }

      shopEl.addEventListener("click", (e) => {
        const btn = e.target.closest("button[data-buy]");
        if(!btn) return;
        const id = btn.getAttribute("data-buy");
        buyFood(id);
      });
    }

    // ---------- –¢–æ—Å—Ç/—Å–æ–æ–±—â–µ–Ω–∏—è ----------
    let toastTimer = 0;
    function toast(msg){
      toastEl.textContent = msg;
      toastTimer = 2.2; // —Å–µ–∫
    }

    // ---------- –î–µ–π—Å—Ç–≤–∏—è ----------
    function applyEffects(fn){
      fn(state.stats);
      // –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
      state.stats.hunger = clamp(state.stats.hunger);
      state.stats.sleep  = clamp(state.stats.sleep);
      state.stats.mood   = clamp(state.stats.mood);
      state.stats.clean  = clamp(state.stats.clean);
      renderUI();
    }

    function buyFood(id){
      const item = foods.find(f => f.id === id);
      if(!item) return;
      if(state.money < item.price){
        toast("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–æ–Ω–µ—Ç ü•≤");
        return;
      }
      state.money -= item.price;
      applyEffects(item.effect);
      toast(`${item.name}: –≤–∫—É—Å–Ω–æ!`);
    }

    function petAction(){
      // –ø–æ–≥–ª–∞–¥–∏—Ç—å: –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚Üë, —Å–æ–Ω —Å–ª–µ–≥–∫–∞ ‚Üë, —á–∏—Å—Ç–æ—Ç–∞ —á—É—Ç—å ‚Üì (—Ä—É–∫–∏ –∂–µ)
      applyEffects(s => { s.mood += 12; s.sleep += 3; s.clean -= 2; });
      toast("–ü–∏—Ç–æ–º–µ—Ü —É—Ä—á–∏—Ç (–Ω–∞–¥–µ—é—Å—å) üòå");
      // –º–∞–ª–µ–Ω—å–∫–∞—è ‚Äú—Ä–∞–¥–æ—Å—Ç—å‚Äù ‚Äî —É—Å–∫–æ—Ä–∏–º –Ω–∞ —Å–µ–∫—É–Ω–¥—É
      state.petV = 110;
      setTimeout(()=> state.petV = 70, 650);
    }

    function throwBall(){
      // –º—è—á–∏–∫: –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚Üë‚Üë, —Å–æ–Ω ‚Üì, —á–∏—Å—Ç–æ—Ç–∞ ‚Üì
      applyEffects(s => { s.mood += 18; s.sleep -= 5; s.clean -= 5; });
      toast("–ü–æ–±–µ–≥–∞–ª–∏! üéæ");

      // –ø—Ä–æ—Å—Ç–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ–ª—ë—Ç–∞ –º—è—á–∞ –ø–æ —Å—Ü–µ–Ω–µ
      const rect = scene.getBoundingClientRect();
      const startX = rect.width * 0.15;
      const endX   = rect.width * 0.85;
      const y      = rect.height * 0.35;

      ball.style.opacity = "1";
      const t0 = performance.now();
      const duration = 650;

      function anim(t){
        const p = Math.min(1, (t - t0)/duration);
        // –ø–∞—Ä–∞–±–æ–ª–∞ (–ø–æ–¥–ª–µ—Ç–∞–µ—Ç –∏ –ø–∞–¥–∞–µ—Ç)
        const x = startX + (endX - startX) * p;
        const arc = Math.sin(Math.PI * p); // 0..1..0
        const yy = y - arc * 90;

        ball.style.left = x + "px";
        ball.style.top  = yy + "px";

        if(p < 1) requestAnimationFrame(anim);
        else {
          ball.style.opacity = "0";
        }
      }
      requestAnimationFrame(anim);

      // –ø–∏—Ç–æ–º–µ—Ü ‚Äú–≥–æ–Ω–∏—Ç—Å—è‚Äù –∑–∞ –º—è—á–æ–º: –º–µ–Ω—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é –Ω–µ–Ω–∞–¥–æ–ª–≥–æ
      state.dir = 1;
      state.petV = 140;
      setTimeout(()=> state.petV = 70, 750);
    }

    petBtn.addEventListener("click", petAction);
    ballBtn.addEventListener("click", throwBall);

    // ---------- –†–µ–Ω–¥–µ—Ä ----------
    function renderUI(){
      moneyEl.textContent = state.money;

      const s = state.stats;
      hungerFill.style.width = s.hunger + "%";
      sleepFill.style.width  = s.sleep  + "%";
      moodFill.style.width   = s.mood   + "%";
      cleanFill.style.width  = s.clean  + "%";

      hungerTxt.textContent = fmt(s.hunger);
      sleepTxt.textContent  = fmt(s.sleep);
      moodTxt.textContent   = fmt(s.mood);
      cleanTxt.textContent  = fmt(s.clean);

      // –∫–Ω–æ–ø–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –µ—Å–ª–∏ –ø–∏—Ç–æ–º–µ—Ü —Å–æ–≤—Å–µ–º ‚Äú—É–º–∏—Ä–∞–µ—Ç‚Äù –æ—Ç –≥–æ–ª–æ–¥–∞/—Å–Ω–∞
      const exhausted = (s.hunger <= 5 || s.sleep <= 5);
      petBtn.disabled = exhausted;
      ballBtn.disabled = exhausted;

      // –º—è–≥–∫–∏–π ‚Äú–∫—Ä–∞—Å–Ω—ã–π —Ñ–ª–∞–≥‚Äù
      if(exhausted) toast("–ü–∏—Ç–æ–º—Ü—É —Å—Ä–æ—á–Ω–æ –Ω—É–∂–Ω–æ –ø–æ–µ—Å—Ç—å –∏–ª–∏ –ø–æ—Å–ø–∞—Ç—å!");
    }

    function renderPet(){
      // –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ü–µ–Ω—ã
      const rect = scene.getBoundingClientRect();
      const margin = 20;
      const maxX = rect.width - 120 - margin; // 120 = —à–∏—Ä–∏–Ω–∞ pet
      state.petX = clamp(state.petX, margin, maxX);

      pet.style.left = state.petX + "px";

      // —Ä–∞–∑–≤–æ—Ä–æ—Ç –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é (scaleX)
      pet.style.transform = `scaleX(${state.dir})`;
    }

    // ---------- –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª ----------
    let last = performance.now();

    function tick(now){
      const dt = Math.min(0.05, (now - last)/1000); // —Å–µ–∫, –æ–≥—Ä–∞–Ω–∏—á–∏–º —Å–∫–∞—á–∫–∏
      last = now;

      // –ø–∞–¥–µ–Ω–∏–µ —Å—Ç–∞—Ç–æ–≤ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
      const s = state.stats;
      s.hunger -= state.decay.hunger * dt;
      s.sleep  -= state.decay.sleep  * dt;
      s.mood   -= state.decay.mood   * dt;
      s.clean  -= state.decay.clean  * dt;

      // –µ—Å–ª–∏ –≥—Ä—è–∑–Ω—ã–π ‚Äî –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —á—É—Ç—å –±—ã—Å—Ç—Ä–µ–µ –ø–∞–¥–∞–µ—Ç
      if(s.clean < 35) s.mood -= 0.35 * dt;

      // –µ—Å–ª–∏ –≥–æ–ª–æ–¥–Ω—ã–π ‚Äî —Å–æ–Ω —Ö—É–∂–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è (—É –Ω–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–Ω–∞ –∫–∞–∫ –¥–µ–π—Å—Ç–≤–∏—è, –Ω–æ –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è)
      // clamp
      s.hunger = clamp(s.hunger);
      s.sleep  = clamp(s.sleep);
      s.mood   = clamp(s.mood);
      s.clean  = clamp(s.clean);

      // —Ö–æ–¥—å–±–∞ —Ç—É–¥–∞-—Å—é–¥–∞
      const rect = scene.getBoundingClientRect();
      const margin = 20;
      const maxX = rect.width - 120 - margin;
      state.petX += state.petV * state.dir * dt;

      if(state.petX >= maxX){
        state.petX = maxX;
        state.dir = -1;
      } else if(state.petX <= margin){
        state.petX = margin;
        state.dir = 1;
      }

      // —Ç–æ—Å—Ç —Ç–∞–π–º–µ—Ä
      if(toastTimer > 0){
        toastTimer -= dt;
        if(toastTimer <= 0) toastEl.textContent = "";
      }

      renderPet();
      renderUI();
      requestAnimationFrame(tick);
    }

    // ---------- –°—Ç–∞—Ä—Ç ----------
    buildShop();
    renderUI();

    // –µ—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å ‚Äî –ø–æ–∫–∞–∂–µ–º –ø–æ–Ω—è—Ç–Ω—É—é –æ—à–∏–±–∫—É
    pet.addEventListener("error", () => {
      toast("–ù–µ –Ω–∞–π–¥–µ–Ω walk.png —Ä—è–¥–æ–º —Å index.html");
    });

    // —Å—Ç–∞—Ä—Ç —Ü–∏–∫–ª–∞
    requestAnimationFrame(tick);

    // –Ω–∞ —Ä–µ—Å–∞–π–∑ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ–º –≥—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener("resize", () => {
      renderPet();
    });
  </script>
</body>
</html>

