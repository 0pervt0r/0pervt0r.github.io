<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ü–∏—Ç–æ–º–µ—Ü-—Å–∏–º—É–ª—è—Ç–æ—Ä</title>
  <style>
    :root{
      --bg:#0f1220; --panel:#171a2b; --panel2:#1e2240; --text:#e9ecff;
      --muted:#aab0d6; --border:#2a2f55;
      --hunger:#ff9a3c; --sleep:#86b6ff; --mood:#ffe97a; --clean:#e9fbff;
      --ok:#55e3a5; --warn:#ffcc66; --bad:#ff6b6b;
    }
    *{box-sizing:border-box; font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial;}
    body{margin:0; background:radial-gradient(1200px 600px at 30% 20%, #1b1f3d 0%, var(--bg) 55%); color:var(--text);}
    .wrap{display:grid; grid-template-columns: 1.3fr 0.7fr; gap:14px; padding:14px; max-width:1100px; margin:0 auto;}
    .game{
      background:linear-gradient(180deg, #14183a, #0d1022);
      border:1px solid var(--border); border-radius:16px; overflow:hidden;
      position:relative; height:420px; box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .hud{
      position:absolute; top:10px; left:10px; right:10px;
      display:flex; gap:10px; align-items:flex-start; justify-content:space-between;
      pointer-events:none;
    }
    .hud .left, .hud .right{display:flex; gap:10px; align-items:flex-start;}
    .card{
      pointer-events:auto;
      background:rgba(23,26,43,.85);
      border:1px solid rgba(42,47,85,.85);
      border-radius:12px; padding:10px;
      backdrop-filter: blur(6px);
      min-width:240px;
    }
    .title{font-weight:700; letter-spacing:.2px;}
    .sub{color:var(--muted); font-size:12px; margin-top:2px;}
    .stats{display:grid; gap:8px; margin-top:10px;}
    .stat{display:grid; gap:6px;}
    .stat-row{display:flex; justify-content:space-between; align-items:center; font-size:12px; color:var(--muted);}
    .bar{
      height:10px; border-radius:999px; background:#0a0d1c; border:1px solid rgba(42,47,85,.7);
      overflow:hidden;
    }
    .fill{height:100%; width:50%; border-radius:999px;}
    .pill{font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.08);}
    .money{font-weight:700;}
    .toast{
      position:absolute; left:50%; transform:translateX(-50%);
      bottom:14px; background:rgba(23,26,43,.92); border:1px solid rgba(42,47,85,.9);
      border-radius:999px; padding:8px 12px; color:var(--text);
      font-size:13px; opacity:0; transition:.25s ease;
      pointer-events:none;
    }
    .toast.show{opacity:1; transform:translateX(-50%) translateY(-4px);}

    /* –°—Ü–µ–Ω–∞ */
    .ground{
      position:absolute; left:0; right:0; bottom:0; height:140px;
      background:linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.35)), linear-gradient(180deg, #1a2146, #0f1330);
      border-top:1px solid rgba(255,255,255,.06);
    }
    .bed{
      position:absolute; bottom:32px; left:50%; transform:translateX(-50%);
      width:200px; height:64px; border-radius:18px;
      border:1px solid rgba(255,255,255,.08);
      box-shadow:0 10px 20px rgba(0,0,0,.25);
    }
    .bed.a{background:linear-gradient(180deg, #2c2f5f, #1a1d44);}
    .bed.b{background:linear-gradient(180deg, #3a2c5f, #241544);}
    .bed.c{background:linear-gradient(180deg, #2c5f56, #14443f);}
    .bed::after{
      content:""; position:absolute; inset:10px; border-radius:14px;
      background:rgba(255,255,255,.06);
      border:1px dashed rgba(255,255,255,.10);
    }

    /* –ü–∏—Ç–æ–º–µ—Ü */
    .pet{
      position:absolute; bottom:86px; left:120px;
      width:72px; height:72px; border-radius:20px;
      background:linear-gradient(180deg, #ff8bd0, #c65bff);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 12px 30px rgba(0,0,0,.35);
      display:grid; place-items:center;
      transform-origin: 50% 90%;
    }
    .face{position:relative; width:46px; height:36px;}
    .eye{position:absolute; top:8px; width:8px; height:8px; border-radius:999px; background:#0d0f1c;}
    .eye.l{left:8px;} .eye.r{right:8px;}
    .mouth{position:absolute; left:50%; bottom:6px; transform:translateX(-50%);
      width:18px; height:10px; border-bottom:3px solid #0d0f1c; border-radius:0 0 18px 18px;
      opacity:.9;
    }
    .pet.walk{animation:bob .45s ease-in-out infinite;}
    .pet.sleeping{filter:saturate(.75) brightness(.9); }
    .pet.sleeping .mouth{border-bottom-color:transparent; width:16px; height:6px; border-top:3px solid #0d0f1c; border-radius:18px;}
    .pet.happy{box-shadow:0 0 0 6px rgba(85,227,165,.12), 0 12px 30px rgba(0,0,0,.35);}
    .pet.dirty{box-shadow:0 0 0 6px rgba(255,204,102,.12), 0 12px 30px rgba(0,0,0,.35);}
    @keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-2px)}}

    /* –ü–∞–Ω–µ–ª–∏ —Å–ø—Ä–∞–≤–∞ */
    .side{
      background:rgba(23,26,43,.8);
      border:1px solid var(--border);
      border-radius:16px;
      padding:12px;
      box-shadow:0 10px 30px rgba(0,0,0,.20);
      height:420px;
      overflow:auto;
    }
    .section{border:1px solid rgba(42,47,85,.8); border-radius:14px; padding:10px; background:rgba(30,34,64,.45); margin-bottom:12px;}
    .section h3{margin:0 0 8px; font-size:14px;}
    .grid{display:grid; gap:8px;}
    button{
      width:100%; padding:9px 10px; border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(15,18,32,.7);
      color:var(--text);
      cursor:pointer;
      transition:.15s ease;
      text-align:left;
    }
    button:hover{transform:translateY(-1px); border-color:rgba(255,255,255,.18);}
    button:active{transform:translateY(0px);}
    button[disabled]{opacity:.5; cursor:not-allowed; transform:none;}
    .row{display:flex; gap:8px;}
    .row button{text-align:center;}
    .hint{color:var(--muted); font-size:12px; line-height:1.35;}
    .small{font-size:12px; color:var(--muted);}

    /* –ú—è—á–∏–∫ */
    .ball{
      position:absolute; bottom:98px; left:40px;
      width:18px; height:18px; border-radius:999px;
      background:linear-gradient(180deg,#ffe97a,#ffb84a);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 8px 16px rgba(0,0,0,.25);
      opacity:0;
    }
    .ball.throw{opacity:1; animation:throw 1.2s ease-in-out forwards;}
    @keyframes throw{
      0%{transform:translate(0,0) scale(1);}
      50%{transform:translate(520px,-120px) scale(1.05);}
      100%{transform:translate(820px,0) scale(1); opacity:0;}
    }

    .pet {
  position: absolute;
  bottom: 86px;
  width: 96px;
  height: 96px;
  pointer-events: none;
}

.pet img {
  width: 100%;
}

  </style>
</head>
<body>
  <div class="wrap">
    <div class="game" id="game">
      <div class="hud">
        <div class="left">
          <div class="card">
            <div class="title">–ü–∏—Ç–æ–º–µ—Ü</div>
            <div class="sub" id="statusText">–ë–æ–¥—Ä—Å—Ç–≤—É–µ—Ç –∏ —à–ª—è–µ—Ç—Å—è –ø–æ –¥–µ–ª–∞–º</div>
            <div class="stats">
              <div class="stat">
                <div class="stat-row"><span>–ì–æ–ª–æ–¥</span><span id="hungerVal">80</span></div>
                <div class="bar"><div class="fill" id="hungerFill" style="background:var(--hunger)"></div></div>
              </div>
              <div class="stat">
                <div class="stat-row"><span>–°–æ–Ω</span><span id="sleepVal">80</span></div>
                <div class="bar"><div class="fill" id="sleepFill" style="background:var(--sleep)"></div></div>
              </div>
              <div class="stat">
                <div class="stat-row"><span>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</span><span id="moodVal">80</span></div>
                <div class="bar"><div class="fill" id="moodFill" style="background:var(--mood)"></div></div>
              </div>
              <div class="stat">
                <div class="stat-row"><span>–ß–∏—Å—Ç–æ—Ç–∞</span><span id="cleanVal">80</span></div>
                <div class="bar"><div class="fill" id="cleanFill" style="background:var(--clean)"></div></div>
              </div>
            </div>
          </div>

          <div class="pet">
  <img id="petSprite" src="walk.png" />
</div>


          <div class="card" style="min-width:170px">
            <div class="title">–ú–æ–Ω–µ—Ç—ã</div>
            <div class="sub">–ö—É–ø–∏—Ç—å –º–æ–∂–Ω–æ –ø–æ—á—Ç–∏ –≤—Å—ë. –ü–æ—á—Ç–∏.</div>
            <div style="margin-top:10px; display:flex; justify-content:space-between; align-items:center;">
              <span class="pill">–ë–∞–ª–∞–Ω—Å</span>
              <span class="money" id="moneyVal">40</span>
            </div>
            <div class="small" style="margin-top:8px;">+1 –º–æ–Ω–µ—Ç–∞ –∫–∞–∂–¥—ã–µ 8 —Å–µ–∫—É–Ω–¥</div>
          </div>
        </div>

        <div class="right">
          <div class="card" style="min-width:210px">
            <div class="title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div>
            <div class="sub">–ú–æ–∂–Ω–æ –∏ –±–µ–∑ –º—ã—à–∫–∏</div>
            <div class="small" style="margin-top:10px; line-height:1.45">
              –ö–ª–∏–∫ –ø–æ —Å—Ü–µ–Ω–µ ‚Äî –ø–æ–≥–ª–∞–¥–∏—Ç—å<br/>
              <b>F</b> ‚Äî –µ–¥–∞ ‚Ä¢ <b>P</b> ‚Äî –ø–æ–≥–ª–∞–¥–∏—Ç—å ‚Ä¢ <b>B</b> ‚Äî –º—è—á–∏–∫
            </div>
          </div>
        </div>
      </div>

      <div class="ball" id="ball"></div>
      <div class="pet" id="pet" aria-label="pet">
        <div class="face">
          <div class="eye l"></div><div class="eye r"></div>
          <div class="mouth"></div>
        </div>
      </div>

      <div class="ground"></div>
      <div class="bed a" id="bed"></div>

      <div class="toast" id="toast"></div>
    </div>

    <div class="side">
      <div class="section">
        <h3>–ï–¥–∞ (–º–∞–≥–∞–∑–∏–Ω)</h3>
        <div class="grid" id="foodShop"></div>
        <div class="hint" style="margin-top:8px;">
          –ï–¥–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞—Ç–æ–≤ —Å—Ä–∞–∑—É ‚Äî –±–∞–ª–∞–Ω—Å –≤–∞–∂–Ω–µ–µ –º–æ—Ä–∞–ª–∏, —á–µ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏.
        </div>
      </div>

      <div class="section">
        <h3>–ò–≥—Ä—ã</h3>
        <div class="row">
          <button id="petBtn">ü§ö –ü–æ–≥–ª–∞–¥–∏—Ç—å</button>
          <button id="ballBtn">‚öæ –ú—è—á–∏–∫</button>
        </div>
        <div class="hint" style="margin-top:8px;">
          –ü–æ–≥–ª–∞–¥–∏—Ç—å ‚Äî —á—É—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö. –ú—è—á–∏–∫ ‚Äî –±–æ–ª—å—à–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, –Ω–æ —Ç—Ä–∞—Ç–∏—Ç —Å–æ–Ω –∏ —á–∏—Å—Ç–æ—Ç—É.
        </div>
      </div>

      <div class="section">
        <h3>–î–µ–∫–æ—Ä</h3>
        <div class="grid" id="decorShop"></div>
        <div class="hint" style="margin-top:8px;">
          –ü–æ–∫–∞ —Ç–æ–ª—å–∫–æ –ª–µ–∂–∞–Ω–∫–∞, –Ω–æ —ç—Ç–æ —É–∂–µ ‚Äú—ç–Ω–¥–≥–µ–π–º‚Äù –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö —Ü–µ–Ω–∏—Ç–µ–ª–µ–π –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞.
        </div>
      </div>

      <div class="section">
        <h3>–ú–∏–Ω–∏-–ª–æ–≥–∏–∫–∞ (—á—Ç–æ —É–∂–µ –µ—Å—Ç—å)</h3>
        <div class="hint">
          –°—Ç–∞—Ç—ã —Å–∞–º–∏ —Ç–∏–∫–∞—é—Ç –≤–Ω–∏–∑ (–≥–æ–ª–æ–¥/—Å–æ–Ω/–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ/—á–∏—Å—Ç–æ—Ç–∞).<br/>
          –ï—Å–ª–∏ —Å–æ–Ω &lt; 20 ‚Äî –ø–∏—Ç–æ–º–µ—Ü –∑–∞—Å—ã–ø–∞–µ—Ç –∏ –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Ç–µ—Ä—è–µ—Ç —Å–æ–Ω, –Ω–æ –≤—Å—ë –µ—â—ë –≥–æ–ª–æ–¥–∞–µ—Ç.<br/>
          –ï—Å–ª–∏ —á–∏—Å—Ç–æ—Ç–∞ &lt; 25 ‚Äî –æ–Ω ‚Äú–≥—Ä—è–∑–Ω—ã–π‚Äù (–≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç).
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  const clamp = (v, a=0, b=100) => Math.max(a, Math.min(b, v));

  // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
  const state = {
    money: 40,
    stats: { hunger: 80, sleep: 80, mood: 80, clean: 80 },
    bed: "a",
    pet: { x: 120, dir: 1, speed: 38, asleep: false } // px, -1/1
  };

  // –¢–æ–≤–∞—Ä—ã
  const foods = [
    {
      id:"kibble", name:"–°—É—Ö–æ–π –∫–æ—Ä–º", price: 6,
      desc:"+20 –≥–æ–ª–æ–¥, +3 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, -2 —á–∏—Å—Ç–æ—Ç–∞",
      effect: s => { s.hunger+=20; s.mood+=3; s.clean-=2; }
    },
    {
      id:"fish", name:"–†—ã–±–∫–∞", price: 10,
      desc:"+28 –≥–æ–ª–æ–¥, +8 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, -6 —á–∏—Å—Ç–æ—Ç–∞",
      effect: s => { s.hunger+=28; s.mood+=8; s.clean-=6; }
    },
    {
      id:"soup", name:"–°—É–ø—á–∏–∫", price: 8,
      desc:"+18 –≥–æ–ª–æ–¥, +10 —Å–æ–Ω, -3 –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ",
      effect: s => { s.hunger+=18; s.sleep+=10; s.mood-=3; }
    }
  ];

  const beds = [
    { id:"a", name:"–õ–µ–∂–∞–Ω–∫–∞: –ù–æ—á—å", price: 18, desc:"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è, —É—é—Ç–Ω–∞—è" },
    { id:"b", name:"–õ–µ–∂–∞–Ω–∫–∞: –§–∏–æ–ª–µ—Ç–æ–≤—ã–π —Ç—É–º–∞–Ω", price: 25, desc:"+—Å—Ç–∏–ª—å (–≤ —Å–µ—Ä–¥—Ü–µ)" },
    { id:"c", name:"–õ–µ–∂–∞–Ω–∫–∞: –ú–æ—Ä—Å–∫–∞—è", price: 25, desc:"–ü–∞—Ö–Ω–µ—Ç –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º–∏ (–ø–æ—á—Ç–∏)" }
  ];

  // DOM
  const game = document.getElementById("game");
  const petEl = document.getElementById("pet");
  const bedEl = document.getElementById("bed");
  const ballEl = document.getElementById("ball");

  const moneyVal = document.getElementById("moneyVal");
  const statusText = document.getElementById("statusText");
  const toastEl = document.getElementById("toast");

  const ui = {
    hungerVal: document.getElementById("hungerVal"),
    sleepVal: document.getElementById("sleepVal"),
    moodVal: document.getElementById("moodVal"),
    cleanVal: document.getElementById("cleanVal"),
    hungerFill: document.getElementById("hungerFill"),
    sleepFill: document.getElementById("sleepFill"),
    moodFill: document.getElementById("moodFill"),
    cleanFill: document.getElementById("cleanFill"),
    foodShop: document.getElementById("foodShop"),
    decorShop: document.getElementById("decorShop"),
    petBtn: document.getElementById("petBtn"),
    ballBtn: document.getElementById("ballBtn"),
  };

  let toastTimer = null;
  function toast(msg){
    toastEl.textContent = msg;
    toastEl.classList.add("show");
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => toastEl.classList.remove("show"), 1200);
  }

  function renderShops(){
    ui.foodShop.innerHTML = "";
    foods.forEach(f => {
      const b = document.createElement("button");
      b.innerHTML = `üçΩÔ∏è <b>${f.name}</b> ‚Äî ${f.price}üí∞<div class="small">${f.desc}</div>`;
      b.onclick = () => buyFood(f.id);
      ui.foodShop.appendChild(b);
    });

    ui.decorShop.innerHTML = "";
    beds.forEach(d => {
      const owned = (state.bed === d.id);
      const b = document.createElement("button");
      b.disabled = owned;
      b.innerHTML = `üõèÔ∏è <b>${d.name}</b> ‚Äî ${d.price}üí∞<div class="small">${owned ? "–£–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ" : d.desc}</div>`;
      b.onclick = () => buyBed(d.id);
      ui.decorShop.appendChild(b);
    });
  }

  function applyStatsDelta(deltaFn){
    const s = state.stats;
    deltaFn(s);
    s.hunger = clamp(s.hunger);
    s.sleep  = clamp(s.sleep);
    s.mood   = clamp(s.mood);
    s.clean  = clamp(s.clean);
  }

  function buyFood(id){
    const item = foods.find(x => x.id === id);
    if (!item) return;
    if (state.money < item.price){ toast("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–æ–Ω–µ—Ç üòÖ"); return; }
    state.money -= item.price;
    applyStatsDelta(item.effect);
    toast(`–°—ä–µ–ª: ${item.name}`);
    render();
  }

  function buyBed(id){
    const item = beds.find(x => x.id === id);
    if (!item) return;
    if (state.money < item.price){ toast("–ö–æ—à–µ–ª—ë–∫ –≥—Ä—É—Å—Ç–∏—Ç"); return; }
    state.money -= item.price;
    state.bed = id;
    toast(`–ù–æ–≤–∞—è –ª–µ–∂–∞–Ω–∫–∞: ${item.name}`);
    renderShops();
    render();
  }

  function petting(){
    applyStatsDelta(s => { s.mood += 7; s.sleep += 1; });
    petEl.classList.add("happy");
    setTimeout(() => petEl.classList.remove("happy"), 450);
    toast("–ü–æ–≥–ª–∞–∂–µ–Ω–æ ‚ú®");
    render();
  }

  function throwBall(){
    // –ê–Ω–∏–º–∞—Ü–∏—è –º—è—á–∏–∫–∞ + —ç—Ñ—Ñ–µ–∫—Ç—ã
    applyStatsDelta(s => { s.mood += 14; s.sleep -= 6; s.clean -= 5; });
    ballEl.classList.remove("throw"); void ballEl.offsetWidth; // –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏
    ballEl.classList.add("throw");
    toast("–ë—Ä–æ—Å–æ–∫! ‚öæ");
    render();
  }

  // –ö–ª–∏–∫ –ø–æ —Å—Ü–µ–Ω–µ ‚Äî –ø–æ–≥–ª–∞–¥–∏—Ç—å
  game.addEventListener("click", (e) => {
    // –ù–µ –ª–æ–≤–∏–º –∫–ª–∏–∫–∏ –ø–æ –∫–Ω–æ–ø–∫–∞–º HUD (–æ–Ω–∏ —Å–≤–µ—Ä—Ö—É)
    if (e.target.closest(".card")) return;
    petting();
  });

  ui.petBtn.onclick = petting;
  ui.ballBtn.onclick = throwBall;

  // –•–æ—Ç–∫–µ–∏
  window.addEventListener("keydown", (e) => {
    const k = e.key.toLowerCase();
    if (k === "p") petting();
    if (k === "b") throwBall();
    if (k === "f") buyFood(foods[0].id);
  });

  // –¢–∏–∫–∏: —ç–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è —Å—Ç–∞—Ç–æ–≤
  setInterval(() => { state.money += 1; render(); }, 8000);

  // –û—Å–Ω–æ–≤–Ω–æ–π —Ç–∏–∫ —Å—Ç–∞—Ç–æ–≤ (–∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É)
  setInterval(() => {
    const s = state.stats;

    // –±–∞–∑–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏
    s.hunger -= 1.4;
    s.mood   -= 0.7;
    s.clean  -= 0.5;

    // —Å–æ–Ω: –µ—Å–ª–∏ —Å–ø–∏—Ç ‚Äî —Å–æ–Ω —Ä–∞—Å—Ç—ë—Ç/–ø–∞–¥–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ (—É—Å–ª–æ–≤–Ω–æ ‚Äú–æ—Ç—Å—ã–ø–∞–µ—Ç—Å—è‚Äù)
    if (state.pet.asleep) s.sleep += 0.6;
    else s.sleep -= 1.0;

    // –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å–∏–Ω–µ—Ä–≥–∏–∏ (—á—É—Ç—å-—á—É—Ç—å, –Ω–æ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º)
    if (s.hunger < 25) s.mood -= 0.6;
    if (s.clean  < 25) s.mood -= 0.4;
    if (s.sleep  < 20) s.mood -= 0.5;

    s.hunger = clamp(s.hunger);
    s.sleep  = clamp(s.sleep);
    s.mood   = clamp(s.mood);
    s.clean  = clamp(s.clean);

    // –°–æ—Å—Ç–æ—è–Ω–∏—è
    state.pet.asleep = (s.sleep < 20) ? true : (s.sleep > 45 ? false : state.pet.asleep);

    render();
  }, 1000);

  // –î–≤–∏–∂–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞
  let last = performance.now();
  function loop(t){
    const dt = (t - last) / 1000;
    last = t;

    const rect = game.getBoundingClientRect();
    const leftBound = 24;
    const rightBound = rect.width - 24 - 72;

    // –ï—Å–ª–∏ —Å–ø–∏—Ç ‚Äî –Ω–µ —Ö–æ–¥–∏—Ç
    if (!state.pet.asleep){
      state.pet.x += state.pet.dir * state.pet.speed * dt;
      if (state.pet.x < leftBound){ state.pet.x = leftBound; state.pet.dir = 1; }
      if (state.pet.x > rightBound){ state.pet.x = rightBound; state.pet.dir = -1; }
    }

    petEl.style.left = `${state.pet.x}px`;
    petEl.style.transform = `scaleX(${state.pet.dir})`;
    petEl.classList.toggle("walk", !state.pet.asleep);

    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);

  function render(){
    const s = state.stats;

    moneyVal.textContent = state.money;

    ui.hungerVal.textContent = Math.round(s.hunger);
    ui.sleepVal.textContent  = Math.round(s.sleep);
    ui.moodVal.textContent   = Math.round(s.mood);
    ui.cleanVal.textContent  = Math.round(s.clean);

    ui.hungerFill.style.width = `${s.hunger}%`;
    ui.sleepFill.style.width  = `${s.sleep}%`;
    ui.moodFill.style.width   = `${s.mood}%`;
    ui.cleanFill.style.width  = `${s.clean}%`;

    bedEl.className = `bed ${state.bed}`;

    petEl.classList.toggle("sleeping", state.pet.asleep);
    petEl.classList.toggle("dirty", s.clean < 25);

    statusText.textContent =
      state.pet.asleep ? "–°–ø–∏—Ç. –¢—Ä–æ–≥–∞—Ç—å –º–æ–∂–Ω–æ, –Ω–æ –æ–Ω –æ—Å—É–¥–∏—Ç." :
      (s.hunger < 25) ? "–ì–æ–ª–æ–¥–Ω—ã–π –≤–∑–≥–ª—è–¥ –ø—Ä–æ–∂–∏–≥–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å" :
      (s.mood < 25) ? "–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: –º—Ä–∞—á–Ω—ã–π —Ñ–∏–ª–æ—Å–æ—Ñ" :
      (s.clean < 25) ? "–ù—É–∂–Ω–æ –±—ã –ø–æ–º—ã—Ç—å—Å—è... –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å" :
      "–ë–æ–¥—Ä—Å—Ç–≤—É–µ—Ç –∏ —à–ª—è–µ—Ç—Å—è –ø–æ –¥–µ–ª–∞–º";
  }

  renderShops();
  render();
})();
</script>
</body>
</html>
